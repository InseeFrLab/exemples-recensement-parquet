```{{ojs}}
renommage_documentation = `SELECT 
  COD_VAR AS nom_variable, 
  LIB_VAR AS description_variable, 
  TYPE_VAR AS type_variable, 
  COD_MOD AS code_modalite, 
  LIB_MOD AS description_modalite`

db = {
  const configuredClient = await DuckDBClient.of({
    logements: FileAttachment("rp_parquet/FD_LOGEMT_2020.parquet"),
    doc: {
        file: FileAttachment("rp_parquet/dictionnaire_variables_2019.csv"),
        header: true
    }
  });

  await configuredClient.query(`
    CREATE OR REPLACE VIEW table_individu 
    AS SELECT * FROM read_parquet("https://www.data.gouv.fr/fr/datasets/r/31c015e6-9c16-4baf-8084-152d6aab2812")`
  ) ;

  await configuredClient.query(`
    CREATE OR REPLACE VIEW table_logement 
    AS SELECT * FROM read_parquet("https://www.data.gouv.fr/fr/datasets/r/f2767d2c-0eb3-448b-b8ed-7f10c44c3441")`
  ) ;

  await configuredClient.query(`
    CREATE OR REPLACE VIEW documentation 
    AS ${renommage_documentation} FROM doc`
  ) ;

  return configuredClient
}
```

```{ojs}
//| echo: false
renommage_documentation = `SELECT 
  COD_VAR AS nom_variable, 
  LIB_VAR AS description_variable, 
  TYPE_VAR AS type_variable, 
  COD_MOD AS code_modalite, 
  LIB_MOD AS description_modalite`

db = {
  const configuredClient = await DuckDBClient.of({
    logements: FileAttachment("rp_parquet/FD_LOGEMT_2020.parquet"),
    doc: {
        file: FileAttachment("rp_parquet/dictionnaire_variables_2019.csv"),
        header: true
    }
  });

  await configuredClient.query(`
    CREATE OR REPLACE VIEW table_individu 
    AS SELECT * FROM read_parquet("https://www.data.gouv.fr/fr/datasets/r/31c015e6-9c16-4baf-8084-152d6aab2812")`
  ) ;

  await configuredClient.query(`
    CREATE OR REPLACE VIEW table_logement 
    AS SELECT * FROM read_parquet("https://www.data.gouv.fr/fr/datasets/r/f2767d2c-0eb3-448b-b8ed-7f10c44c3441")`
  ) ;

  await configuredClient.query(`
    CREATE OR REPLACE VIEW documentation 
    AS ${renommage_documentation} FROM doc`
  ) ;

  return configuredClient
}
```

